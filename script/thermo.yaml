#thermo
auto_thermo:
  alias: "Thermostat weather control"
  sequence:
    - service: thermostat.set_hvac_mode
      data:
        entity_id: thermostat.home
        hvac_mode: 'auto'

    - service: thermostat.set_target_temp_high
      data_template:
        target_temp_high: >
          {% if states.sensor.weather_temperature.state | float >= 75.0 %}
            {{ 67|round }}
          {% elif states.sensor.weather_temperature.state | float >= 70.0 %}
            {{ 68|round }}
          {% elif states.sensor.weather_temperature.state | float >= 65.0 %}
            {{ 71|round }}
          {% elif states.sensor.weather_temperature.state | float >= 60.0 %}
            {{ 72|round }}
          {% elif states.sensor.weather_temperature.state | float >= 55.0 %}
            {{ 73|round }}
          {% elif states.sensor.weather_temperature.state | float >= 50.0 %}
            {{ 74|round }}
          {% elif states.sensor.weather_temperature.state | float >= 45.0 %}
            {{ 76|round }}
          {% elif states.sensor.weather_temperature.state | float >= 40.0 %}
            {{ 77|round }}
          {% else %}
          {% endif %}

    - event: LOGBOOK_ENTRY
      event_data:
        name: Weather Controlled Thermostat
        message: set new range
        entity_id: thermostat.home
        domain: thermostat
